name: Deploy to Render

on:
  push:
    branches: [ main ]
    paths:
      - 'tg_bot/**'
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: ðŸ“¥ Checkout code
      uses: actions/checkout@v4
    
    - name: ðŸš€ Deploy to Render
      env:
        RENDER_API_KEY: ${{ secrets.RENDER_API_KEY }}
        RENDER_SERVICE_ID: ${{ secrets.RENDER_SERVICE_ID }}
      run: |
        echo "Ð”ÐµÐ¿Ð»Ð¾Ð¹ Ð½Ð° Render..."
        
        # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹ Ñ„Ð°Ð¹Ð» Ð´Ð»Ñ Ð´ÐµÐ¿Ð»Ð¾Ñ
        cat > deploy_info.md << EOF
        # Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ Ð´ÐµÐ¿Ð»Ð¾Ñ
        
        ## Ð¤Ð°Ð¹Ð»Ñ‹ Ð±Ð¾Ñ‚Ð°:
        - tg_bot/package.json
        - tg_bot/bot.js
        - tg_bot/services.js  
        - tg_bot/students.js
        
        ## ÐšÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ°:
        \`\`\`bash
        cd tg_bot
        npm install
        npm start
        \`\`\`
        
        ## ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ:
        - BOT_TOKEN (ÑƒÐ¶Ðµ Ð² ÐºÐ¾Ð´Ðµ)
        - FIREBASE ÐºÐ»ÑŽÑ‡ (ÑƒÐ¶Ðµ Ð² ÐºÐ¾Ð´Ðµ)
        
        ## GitHub Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹:
        ${{ github.repository }}
        
        ## ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚:
        ${{ github.sha }}
        EOF
        
        echo "Ð¤Ð°Ð¹Ð» deploy_info.md ÑÐ¾Ð·Ð´Ð°Ð½"
        cat deploy_info.md
